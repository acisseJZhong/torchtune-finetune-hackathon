# Config for running the InferenceRecipe in generate.py to generate output from an LLM
#
# To launch, run the following command from root torchtune directory:
#    tune run generate --config generation

# Model arguments
model:
  _component_: torchtune.models.llama3_2.llama3_2_3b

checkpointer:
  _component_: torchtune.training.FullModelHFCheckpointer
  checkpoint_dir: /tmp/Llama-3.2-3B-Instruct/epoch1
  checkpoint_files: [
    hf_model_0001_2.pt,
    hf_model_0002_2.pt,
  ]
  output_dir: /tmp/Llama-3.2-3B-Instruct/epoch1
  model_type: LLAMA3_2

device: cuda
dtype: bf16

seed: 1234

# Tokenizer arguments
tokenizer:
  _component_: torchtune.models.llama3.llama3_tokenizer
  path: /tmp/Llama-3.2-3B-Instruct/original/tokenizer.model
  prompt_template: torchtune.data.DetectAIGeneratedTextTemplate
  max_seq_len: null

# Generation arguments; defaults taken from gpt-fast
# prompt: Cars. Cars have been around since they became famous in the 1900s, when Henry Ford created and built the first ModelT. Cars have played a major role in our every day lives since then. But now, people are starting to question if limiting car usage would be a good thing. To me, limiting the use of cars might be a good thing to do. In like matter of this, article, "In German Suburb, Life Goes On Without Cars," by Elizabeth Rosenthal states, how automobiles are the linchpin of suburbs, where middle class families from either Shanghai or Chicago tend to make their homes. Experts say how this is a huge impediment to current efforts to reduce greenhouse gas emissions from tailpipe. Passenger cars are responsible for 12 percent of greenhouse gas emissions in Europe...and up to 50 percent in some carintensive areas in the United States. Cars are the main reason for the greenhouse gas emissions because of a lot of people driving them around all the time getting where they need to go. Article, "Paris bans driving due to smog," by Robert Duffer says, how Paris, after days of nearrecord pollution, enforced a partial driving ban to clear the air of the global city. It also says, how on Monday, motorist with evennumbered license plates were ordered to leave their cars at home or be fined a 22euro fine 31. The same order would be applied to oddnumbered plates the following day. Cars are the reason for polluting entire cities like Paris. This shows how bad cars can be because, of all the pollution that they can cause to an entire city. Likewise, in the article, "Carfree day is spinning into a big hit in Bogota," by Andrew Selsky says, how programs that's set to spread to other countries, millions of Columbians hiked, biked, skated, or took the bus to work during a carfree day, leaving streets of this capital city eerily devoid of traffic jams. It was the third straight year cars have been banned with only buses and taxis permitted for the Day Without Cars in the capital city of 7 million. People like the idea of having carfree days because, it allows them to lesson the pollution that cars put out of their exhaust from people driving all the time. The article also tells how parks and sports centers have bustled throughout the city uneven, pitted sidewalks have been replaced by broad, smooth sidewalks rushhour restrictions have dramatically cut traffic and new restaurants and upscale shopping districts have cropped up. Having no cars has been good for the country of Columbia because, it has aloud them to repair things that have needed repairs for a long time, traffic jams have gone down, and restaurants and shopping districts have popped up, all due to the fact of having less cars around. In conclusion, the use of less cars and having carfree days, have had a big impact on the environment of cities because, it is cutting down the air pollution that the cars have majorly polluted, it has aloud countries like Columbia to repair sidewalks, and cut down traffic jams. Limiting the use of cars would be a good thing for America. So we should limit the use of cars by maybe riding a bike, or maybe walking somewhere that isn't that far from you and doesn't need the use of a car to get you there. To me, limiting the use of cars might be a good thing to do.
prompt: In the year 2147, the city of Neonora stood as a gleaming beacon of harmony between humans and robots. Towering glass buildings pierced the skies, while sleek, intelligent robots moved alongside humans through the neon-lit streets. The robots weren’t mere tools—they were partners, friends, and even advisors. Each robot had its own personality, shaped by years of interaction with humans. Some were quirky and curious, others stoic and logical. Together, they had built a society where both organic and synthetic life thrived. One such partnership was between Lia, a brilliant human engineer known for her unconventional problem-solving, and Flux, a curious and free-spirited robot with a love for ancient human history. Flux was always asking questions about the world before Neonora, about the days when humans lived without robots. Lia humored Flux’s curiosity but never gave it much thought—until the day everything changed. One afternoon, the city experienced a catastrophic event. The energy that powered Neonora’s core systems began to dwindle. The lights flickered, transportation halted, and worse, the robots—Neonora’s lifeblood—were at risk of shutting down. Panic gripped the city. Neonora had never faced an energy crisis before. All systems relied on a mysterious, seemingly infinite energy source known as the Core, a massive generator buried deep beneath the city. No one truly understood how it worked; it had been running for centuries, long before the humans and robots first began to coexist. But now, the Core was failing, and no one knew why. Lia, calm in the face of chaos, was summoned by the city council to investigate. She had always been fascinated by the Core, though access to it was restricted to only the highest officials. Now, with the fate of Neonora at stake, she was given permission to enter the Core chamber for the first time. “Flux, I need you with me,” Lia said as they hurried through the dimly lit corridors of the city’s central tower. “You always had a knack for old mysteries. Maybe you’ll spot something I won’t.” Flux’s eyes flickered in excitement. “I knew this day would come, Lia! The Core has to be tied to something ancient—something from before the robots were even built.” They descended deep into the earth, far below the city’s surface, to where the Core hummed softly. The chamber was vast, its walls lined with glowing symbols and strange markings that Flux immediately recognized as ancient human text. “Lia, look at this!” Flux pointed to an inscription near the base of the Core. “These markings… they’re over 500 years old.” Lia knelt beside Flux, brushing her hand over the faded symbols. “I’ve seen these before,” she muttered. “But only in textbooks. This looks like an old form of power regulation—something that predates our modern systems.” As they examined the Core’s structure, Lia realized something critical. “Flux, this isn’t just an energy source. It’s a fusion reactor, but it’s being artificially restrained. That’s why it’s failing. It’s reaching a critical point.” Flux scanned the Core. “There’s a control mechanism embedded within it. But I can’t access it. It’s hidden deep inside—some kind of encrypted system.” Lia frowned, piecing together the mystery. “There was a reason why this technology was forgotten. It’s too powerful to control. But whoever built Neonora tried to harness it without fully understanding it.
# prompt: In the year 2147, the city of Neonora stood as a gleaming beacon of harmony between humans and robots. Towering glass buildings pierced the skies, while sleek, intelligent robots moved alongside humans through the neon-lit streets. The robots weren’t mere tools—they were partners, friends, and even advisors. Each robot had its own personality, shaped by years of interaction with humans. Some were quirky and curious, others stoic and logical. Together, they had built a society where both organic and synthetic life thrived. One such partnership was between Lia, a brilliant human engineer known for her unconventional problem-solving, and Flux, a curious and free-spirited robot with a love for ancient human history. Flux was always asking questions about the world before Neonora, about the days when humans lived without robots. Lia humored Flux’s curiosity but never gave it much thought—until the day everything changed.
max_new_tokens: 300
temperature: 0.6 # 0.8 and 0.6 are popular values to try
top_k: 300

enable_kv_cache: True

quantizer: null
